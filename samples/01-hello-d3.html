<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>01 - Hello D3.js</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        h1 {
            color: #333;
        }
        .description {
            background: #fff;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        #container {
            background: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .greeting {
            font-size: 24px;
            color: #4a90d9;
            padding: 10px;
            margin: 5px 0;
            border-left: 4px solid #4a90d9;
            background: #f0f7ff;
        }
    </style>
</head>
<body>
    <h1>01 - Hello D3.js</h1>
    <div class="description">
        <p><strong>学習ポイント:</strong> D3.jsの基本的なDOM操作 - 要素の選択、追加、テキスト設定、スタイル適用</p>
    </div>
    <div id="container"></div>

    <!-- D3.js ライブラリをCDNから読み込み -->
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script>
        // ============================================
        // D3.jsの基本: DOM要素の選択と操作
        // ============================================

        // d3.select() は CSS セレクタを使って単一の要素を選択します
        // jQueryの $() に似ていますが、D3.js独自のメソッドチェーンが使えます
        const container = d3.select("#container");

        // ============================================
        // 要素の追加とテキスト設定
        // ============================================

        // append() で新しい要素を追加し、text() でテキストを設定
        // メソッドチェーンで連続して操作できます
        container.append("h2")
            .text("D3.jsへようこそ！");

        // style() でCSSスタイルを直接適用できます
        // 第1引数: CSSプロパティ名、第2引数: 値
        container.append("p")
            .text("D3.js（Data-Driven Documents）は、データに基づいてDOMを操作するJavaScriptライブラリです。")
            .style("color", "#666");

        // ============================================
        // データバインディングの基本
        // ============================================

        // 表示したいデータの配列を用意
        const greetings = ["こんにちは", "Hello", "Bonjour", "你好", "مرحبا"];

        // selectAll() で複数の要素を選択（まだ存在しなくても OK）
        // data() でデータ配列をバインド（紐付け）
        // enter() は「データはあるけど対応するDOM要素がない」状態を表す
        // append() で各データに対応する要素を作成
        // attr() で属性を設定、text() でテキストを設定
        container.selectAll(".greeting")  // まだ .greeting 要素は存在しない
            .data(greetings)              // データ配列をバインド
            .enter()                      // データ数分の「入り口」を取得
            .append("div")                // 各データに対して div を追加
            .attr("class", "greeting")    // class 属性を設定
            .text(d => d);                // d はデータ配列の各要素（アロー関数）

        // ============================================
        // 動的なスタイル設定
        // ============================================

        // style() の第2引数に関数を渡すと、各要素ごとに異なる値を設定できます
        // d: データの値、i: インデックス（0から始まる連番）
        container.selectAll(".greeting")
            .style("opacity", (d, i) => 1 - i * 0.15);  // i=0 → 1.0, i=1 → 0.85, i=2 → 0.70...
    </script>
</body>
</html>
